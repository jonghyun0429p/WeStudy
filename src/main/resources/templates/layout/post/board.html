<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <th:block th:replace="~{layout/layout :: head}"></th:block>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="stylesheet" th:href="@{/css/board.css}" />
</head>

<body>
<div th:replace="~{layout/layout :: layout(~{::content})}"
     th:with="mainClass='default-main'">
    <div th:fragment="content" class="post-board">

        <h2 class="board-title mb-3">ğŸ“‹ ê²Œì‹œê¸€ ëª©ë¡</h2>

        <!-- ê²Œì‹œê¸€ ëª©ë¡ -->
        <div class="post-list">
            <div th:each="post : ${pages}" class="card"
                 th:attr="data-post-id=${post.postId}"
                 onclick="goToDetail(this)">
                <div class="card-body">
                    <h5 class="card-title" th:text="${post.title}">ì œëª©</h5>
                    <h6 class="card-subtitle">
                        ì¹´í…Œê³ ë¦¬: <span th:text="${post.postCategory}">ì¹´í…Œê³ ë¦¬</span> |
                        ì¡°íšŒìˆ˜: <span th:text="${post.views}">0</span>
                    </h6>
                    <p class="card-text" th:text="${post.summary}">ìš”ì•½ ë‚´ìš©</p>
                </div>
            </div>
        </div>

        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div class="pagination mt-4">
            <nav>
                <ul class="pagination justify-content-center">
                    <li class="page-item">
                        <a class="page-link" th:href="@{'/page/post?page=1'}">ì²˜ìŒ</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" th:href="@{/page/post(page=${currentPage - 1 > 0 ? currentPage - 1 : 1})}">ì´ì „</a>
                    </li>
                    <li class="page-item">
                        <span class="page-link" th:text="'í˜„ì¬ í˜ì´ì§€: ' + ${currentPage}">í˜„ì¬ í˜ì´ì§€</span>
                    </li>
                    <li class="page-item">
                        <a class="page-link" th:href="@{/page/post(page=${currentPage + 1 < pageCount ? currentPage + 1 : pageCount })}">ë‹¤ìŒ</a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- ê²€ìƒ‰ì°½ -->
        <form class="mt-4 d-flex justify-content-center" th:action="@{/page/post/search}" method="get">
            <input type="text" name="keyword" class="form-control w-50 me-2" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
            <button type="submit" class="btn btn-outline-secondary">ê²€ìƒ‰</button>
        </form>

        <!-- ìš°ì¸¡ í•˜ë‹¨ ê¸€ ì‘ì„± ë²„íŠ¼ -->
        <th:block th:if="${nickname != null}">
            <a href="/page/post/write" class="btn btn-primary position-fixed"
               style="bottom: 3rem; right: 2rem; z-index: 1000;">
                âœ ê¸€ ì‘ì„±
            </a>
        </th:block>

    </div>
</div>

<script>
    function goToDetail(element) {
        const postId = element.getAttribute("data-post-id");
        if (postId) {
            window.location.href = `/page/post/detail?id=${postId}`;
        }
    }
</script>
</body>
</html>
