<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
    <th:block th:replace="~{layout/layout :: head}"></th:block>
    <title>관리자 페이지 - 게시글 관리</title>
</head>

<body>
    <div th:replace="~{layout/layout :: layout(~{::content}, contentMaxWidthClass='max-w-[1200px]')}"
        th:with="mainClass='bg-background-light dark:bg-background-dark'">
        <div th:fragment="content">

            <!-- Page Header -->
            <div class="mb-8 mt-4">
                <h1 class="text-3xl font-black tracking-tight text-text-light-primary dark:text-text-dark-primary">관리자
                    대시보드</h1>
                <p class="text-text-light-secondary dark:text-text-dark-secondary mt-2">사이트 콘텐츠 및 회원을 관리하세요.</p>
            </div>

            <!-- Tab Navigation -->
            <div class="mb-8 border-b border-border-light dark:border-border-dark">
                <nav class="flex gap-8" aria-label="Tabs">
                    <a href="/page/admin/qa"
                        class="border-transparent text-text-light-secondary dark:text-text-dark-secondary hover:text-text-light-primary dark:hover:text-text-dark-primary hover:border-gray-300 border-b-2 py-4 px-1 text-sm font-medium flex items-center gap-2 transition-colors">
                        <span class="material-symbols-outlined">help</span>
                        Q&A 관리
                    </a>
                    <a href="/page/admin/user"
                        class="border-transparent text-text-light-secondary dark:text-text-dark-secondary hover:text-text-light-primary dark:hover:text-text-dark-primary hover:border-gray-300 border-b-2 py-4 px-1 text-sm font-medium flex items-center gap-2 transition-colors">
                        <span class="material-symbols-outlined">group</span>
                        유저 관리
                    </a>
                    <a href="/page/admin/post"
                        class="border-primary text-primary border-b-2 py-4 px-1 text-sm font-bold flex items-center gap-2">
                        <span class="material-symbols-outlined">article</span>
                        게시글 관리
                    </a>
                </nav>
            </div>

            <!-- Post Manage Section -->
            <section class="space-y-6">
                <div class="flex items-center justify-between">
                    <h2
                        class="text-xl font-bold text-text-light-primary dark:text-text-dark-primary flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">feed</span>
                        전체 게시글 관리
                    </h2>
                    <div class="flex gap-2">
                        <select class="std-input h-10 py-1 text-sm w-32">
                            <option>전체 카테고리</option>
                            <option>스터디 모집</option>
                            <option>자유게시판</option>
                        </select>
                        <input type="text" placeholder="제목 또는 내용 검색" class="std-input h-10 py-1 text-sm w-64">
                        <button class="std-btn std-btn-primary h-10 px-4 text-sm">검색</button>
                    </div>
                </div>

                <!-- Post Table -->
                <div
                    class="bg-surface-light dark:bg-surface-dark rounded-xl border border-border-light dark:border-border-dark overflow-hidden shadow-sm">
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead
                                class="bg-primary/5 text-text-light-primary dark:text-text-dark-primary font-bold border-b border-border-light dark:border-border-dark">
                                <tr>
                                    <th class="px-6 py-4 w-20">No</th>
                                    <th class="px-6 py-4 w-32">카테고리</th>
                                    <th class="px-6 py-4">제목</th>
                                    <th class="px-6 py-4 w-32">작성자</th>
                                    <th class="px-6 py-4 w-24 text-center">신고</th>
                                    <th class="px-6 py-4 w-24 text-center">상태</th>
                                    <th class="px-6 py-4 w-48 text-center">관리</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-border-light dark:divide-border-dark">
                                <!-- Post 1 (Reported) -->
                                <tr class="hover:bg-primary/5 transition-colors bg-red-50/50 dark:bg-red-900/10">
                                    <td class="px-6 py-4 text-text-light-secondary dark:text-text-dark-secondary">5521
                                    </td>
                                    <td class="px-6 py-4 text-text-light-secondary dark:text-text-dark-secondary">자유게시판
                                    </td>
                                    <td class="px-6 py-4">
                                        <a href="#"
                                            class="font-medium text-text-light-primary dark:text-text-dark-primary hover:text-primary hover:underline"
                                            onclick="alert('게시글 상세 페이지로 이동합니다 (구현 예정)')">
                                            광고성 게시글입니다. 클릭하세요!!!
                                        </a>
                                    </td>
                                    <td class="px-6 py-4 text-text-light-secondary dark:text-text-dark-secondary">
                                        spammer99</td>
                                    <td class="px-6 py-4 text-center text-red-500 font-bold">15</td>
                                    <td class="px-6 py-4 text-center">
                                        <span
                                            class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300">
                                            게시중
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <div class="flex justify-center gap-2">
                                            <button onclick="toggleLockPost(5521, this)"
                                                class="px-3 py-1.5 text-xs font-bold text-gray-600 bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 rounded transition-colors group">
                                                <span
                                                    class="material-symbols-outlined text-[14px] align-middle mr-1 group-hover:hidden">lock_open</span>
                                                <span
                                                    class="material-symbols-outlined text-[14px] align-middle mr-1 hidden group-hover:inline">lock</span>
                                                잠금
                                            </button>
                                            <button onclick="deletePost(5521)"
                                                class="px-3 py-1.5 text-xs font-bold text-red-600 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300 dark:hover:bg-red-900/50 rounded transition-colors">
                                                삭제
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <!-- Post 2 (Locked) -->
                                <tr class="hover:bg-primary/5 transition-colors bg-gray-50 dark:bg-white/5">
                                    <td class="px-6 py-4 text-text-light-secondary dark:text-text-dark-secondary">5520
                                    </td>
                                    <td class="px-6 py-4 text-text-light-secondary dark:text-text-dark-secondary">스터디 모집
                                    </td>
                                    <td class="px-6 py-4">
                                        <span class="text-gray-400 dark:text-gray-500 line-through">
                                            [마감] 프론트엔드 스터디원 구해요
                                        </span>
                                        <span
                                            class="ml-2 text-xs text-gray-400 border border-gray-300 rounded px-1">잠금됨</span>
                                    </td>
                                    <td class="px-6 py-4 text-text-light-secondary dark:text-text-dark-secondary">
                                        study_king</td>
                                    <td class="px-6 py-4 text-center text-gray-400">0</td>
                                    <td class="px-6 py-4 text-center">
                                        <span
                                            class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">
                                            잠금
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <div class="flex justify-center gap-2">
                                            <button onclick="toggleLockPost(5520, this)"
                                                class="px-3 py-1.5 text-xs font-bold text-blue-600 bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:hover:bg-blue-900/50 rounded transition-colors">
                                                해제
                                            </button>
                                            <button onclick="deletePost(5520)"
                                                class="px-3 py-1.5 text-xs font-bold text-red-600 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300 dark:hover:bg-red-900/50 rounded transition-colors">
                                                삭제
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <script>
                // 1. 게시글 잠금/해제 (Lock/Unlock)
                async function toggleLockPost(postId, btnElement) {
                    // 현재 버튼 텍스트나 상태로 토글 판단 (데모용)
                    const isLocked = btnElement.innerText.includes('해제');
                    const action = isLocked ? '해제' : '잠금';
                    const confirmMsg = `게시글 No.${postId}를 ${action}하시겠습니까?`;

                    if (!confirm(confirmMsg)) return;

                    try {
                        // Mock API Call
                        console.log(`[API REQUEST] PUT /api/admin/posts/${postId}/lock`, { locked: !isLocked });
                        alert(`게시글이 성공적으로 ${action} 처리되었습니다.`);
                        // location.reload();
                    } catch (error) {
                        console.error(error);
                        alert('작업 중 오류가 발생했습니다.');
                    }
                }

                // 2. 게시글 삭제 (Delete) - 강력한 경고 알림
                async function deletePost(postId) {
                    const isConfirmed = confirm(`[경고] 정말로 게시글 No.${postId}를 삭제하시겠습니까?\n\n- 삭제된 게시글은 복구할 수 없습니다.\n- 관련된 댓글 및 데이터도 함께 삭제됩니다.`);

                    if (!isConfirmed) return;

                    try {
                        // Mock API Call
                        console.log(`[API REQUEST] DELETE /api/admin/posts/${postId}`);
                        alert('게시글이 영구 삭제되었습니다.');
                        // location.reload();
                    } catch (error) {
                        console.error(error);
                        alert('작업 중 오류가 발생했습니다.');
                    }
                }
            </script>

        </div>
    </div>
</body>

</html>